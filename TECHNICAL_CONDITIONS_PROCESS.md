# Бизнес-процесс «Разработка технических условий»

## Обзор

Данный документ описывает полный бизнес-процесс разработки технических условий (ТУ) в системе VoltUp, включая все этапы от подготовки основных технических решений (ОТР) до финального утверждения.

## Этапы процесса

### 1. Подготовка ОТР (Основных технических решений)

**Компонент:** `OtrPreparation.jsx`

**Описание:** После проверки заявки на ТП запускается процесс подготовки основных технических решений.

**Функциональность:**

- Заполнение основных реквизитов ОТР:
  - Тип тарифа для расчета
  - Удаленность объекта
- Структура сети точек присоединения:
  - Автоматическое заполнение по справочнику "Структура сети"
  - Генерация цепочки структуры сети
- Мероприятия, выполняемые сетевой организацией:
  - Добавление мероприятий с указанием раздела ТУ, напряжения, протяженности
- Мероприятия, выполняемые заявителем:
  - Добавление мероприятий без детализации затрат
- Подписывающие лица:
  - Указание сотрудника и его должности

**Кнопка действия:** "Создать новое предложение к ТУ"

### 2. Подготовка ТУ

**Компонент:** `TechnicalConditions.jsx`

**Описание:** Технические условия создаются на основании основных технических решений.

**Функциональность:**

- Выбор ОТР из ранее подготовленных документов
- Автоматическое заполнение данных из ОТР
- Проверка заполнения реквизитов
- Заполнение подписывающих лиц
- Отметка признака "Требуется заявка в ССО"

**Кнопка действия:** "Создать документ ТУ"

### 3. Согласование и утверждение ТУ в РЭС

**Компонент:** `TuApprovalRes.jsx`

**Описание:** Пользователь проверяет заполнение всех реквизитов и отмечает результат согласования.

**Функциональность:**

- Просмотр всех данных ТУ и ОТР
- Проверка подписывающих лиц
- Просмотр прикрепленных документов
- Возможные результаты:
  - "Согласовано" - переход к утверждению ИА Филиала
  - "Есть замечания" - указание комментариев
  - "Требуется изменение" - запуск БП заново

**Кнопки действий:**

- "Согласовано"
- "Есть замечания"
- "Требуется изменение"

### 4. Утверждение ТУ ИА Филиала

**Компонент:** `TuApprovalIa.jsx`

**Описание:** Финальное утверждение технических условий в ИА Филиала.

**Функциональность:**

- Просмотр согласованных технических условий
- Проверка статуса согласования в РЭС
- Просмотр всех данных ОТР и ТУ
- Финальное утверждение

**Кнопка действия:** "Утверждено"

### 5. Вложенный бизнес-процесс ССО

**Компонент:** `SsoProcess.jsx`

**Описание:** Процесс взаимодействия со смежной сетевой организацией.

**Этапы:**

1. **Подготовить уведомление о запросе в ССО заявителю**

   - Заполнение реквизитов: вид отправки, дата отправки
   - Выбор вида документа и описание проблемы
   - Заполнение подписывающих лиц и адресата

2. **Подготовить и отправить заявку в ССО**

   - Прикрепление файлов к техническим условиям
   - Подтверждение отправки

3. **Отправить уведомление о запросе в ССО заявителю**

   - Подтверждение факта отправки уведомления

4. **Получить ответ от ССО**

   - Обработка полученного договора ССО
   - Обработка замечаний от ССО

5. **Устранить замечания по заявке в ССО**

   - Исправление замечаний
   - Повторная отправка заявки

6. **Регистрация договора с ССО**
   - Выбор вида договора
   - Заполнение реквизитов договора
   - Регистрация в системе

## Интеграция с системой

### Redux Store

**Slice:** `technicalSlice.js`

**Состояния:**

- `technicalConditions` - массив технических условий
- `otrDocuments` - массив документов ОТР

**Actions:**

- `createOtr` - создание ОТР
- `updateOtr` - обновление ОТР
- `approveOtr` - согласование ОТР
- `createTechnicalCondition` - создание ТУ
- `updateTechnicalCondition` - обновление ТУ
- `approveTechnicalCondition` - согласование ТУ
- `startSsoProcess` - запуск процесса ССО

### Маршрутизация

**Маршруты:**

- `/otr/:appId` - подготовка ОТР
- `/technical/:appId` - подготовка ТУ
- `/tu-approval-res/:appId` - согласование в РЭС
- `/tu-approval-ia/:appId` - утверждение ИА Филиала
- `/sso/:appId` - процесс ССО

### Навигация

**EmployeePanel:**

- Кнопка "Создать ОТР" для заявок со статусом "Проверена"
- Кнопка "Перейти к ТУ" для заявок со статусом "ОТР готово"
- Кнопка "Согласование в РЭС" для заявок со статусом "ТУ создано"
- Кнопка "Утверждение ИА" для заявок со статусом "Согласовано в РЭС"

## Стилизация

### Файлы стилей:

- `otr-preparation.scss` - стили для подготовки ОТР
- `tu-approval-res.scss` - стили для согласования в РЭС
- `tu-approval-ia.scss` - стили для утверждения ИА Филиала
- `technical.scss` - стили для подготовки ТУ
- `sso-process.scss` - стили для процесса ССО

### Дизайн-система:

- Градиентные фоны для различных этапов
- Карточки с тенями и скругленными углами
- Адаптивная верстка для мобильных устройств
- Иконки Material Design
- Анимации переходов и hover-эффектов

## Валидация и обработка ошибок

### Валидация ОТР:

- Обязательные поля: тип тарифа, удаленность объекта
- Проверка корректности структуры сети
- Валидация мероприятий

### Валидация ТУ:

- Проверка наличия ОТР
- Валидация подписывающих лиц
- Проверка прикрепленных документов

### Обработка ошибок:

- Показ сообщений об ошибках
- Блокировка кнопок при невалидных данных
- Возможность возврата к предыдущим этапам

## Расширяемость

### Возможные улучшения:

1. Интеграция с внешними системами для получения данных о структуре сети
2. Автоматическая генерация документов ТУ
3. Система уведомлений о статусе процесса
4. Интеграция с электронной подписью
5. Экспорт данных в различные форматы
6. Система отчетности и аналитики

### Архитектурные решения:

- Модульная структура компонентов
- Переиспользуемые UI-компоненты
- Централизованное управление состоянием
- Типизированные интерфейсы данных
- Отзывчивый дизайн

## Заключение

Реализованный бизнес-процесс полностью соответствует описанию и обеспечивает:

- Пошаговое выполнение всех этапов
- Контроль качества на каждом этапе
- Возможность возврата к предыдущим этапам
- Интеграцию с вложенными процессами
- Современный и удобный интерфейс
- Масштабируемость и расширяемость системы
